# Empty state
unit_0_empty_state:
  context:
    locale: 'en'
    period: '2021-12-31'
  data:
    periods:
      2021-12-31:
        reconciliations:
          nl_tax_status:
            custom: {}
  expectation:
    results: &zero_results_bp
      approval: false
      approval_date: null
      approval_name: null
      result_cy_a_priori: 0
    reconciled: false
    rollforward:
      check.approval: null

# Unit 1: incoming result
unit_1_incoming_result_test_1:
  context:
    locale: 'en'
    period: '2019-12-31'
  data:
    periods:
      2019-12-31:
        accounts: &basic_pl_accounts_bp
          WOvbBue.000:
            value: -12000
          WPerLesLon.000:
            value: 2000
          WBedAutBra.000:
            value: 4000
        reconciliations:
          nl_tax_status:
            custom: 
              equity.method: false
  expectation:
    results:
      <<: *zero_results_bp
      result_cy_a_priori: 6000
    reconciled: false
    rollforward:
      check.approval: null

unit_1_incoming_result_test_2:
  context:
    locale: 'en'
    period: '2019-12-31'
  data:
    periods:
      2019-12-31:
        reconciliations:
          proposal_profit_distribution:
            custom: {}
          general_settings: 
            custom:
              balance.appropriation: 1
          nl_tax_status:
            custom: 
              equity.method: true
        accounts:
          BLasSak.000:
            value: -1000
          BVorDeb.000:
            value: 4000
  expectation:
    results:
      <<: *zero_results_bp
      result_cy_a_priori: 3000
    reconciled: false
    rollforward:
      check.approval: null

unit_1_incoming_result_test_3:
  context:
    locale: en
    period: 2019-12-31
  data:
    company:
      city: 1234 AB Amsterdam
      company_form: BV
      company_type: consolidation
      country: NL
      currency: JPY
      file_code: '12245676'
      name: Test dossier - quarterly calendar year - company
      periods_per_year: 4
      street: van Ginsbergenstraat 47
      vat_identifier: '12245676'
    periods:
      2019-12-31:
        accounts: &all_accounts_bp
          BEff.000:
            id: 175950397
            value: 0.0
          BEivGokGea.000:
            id: 169784700
            value: -15882.0
          BEivKapPro.000:
            id: 169784701
            value: 0.0
          BEivOreOvw.000:
            id: 169784702
            value: -437241.67
          BEivOvr.000:
            id: 178132455
            value: 0.0
          BFvaDigNev.000:
            id: 169784703
            value: 396513.0
          BFvaLbvBll.000:
            id: 169784704
            value: 0.0
          BFvaLbvBll.001:
            id: 169784705
            value: 0.0
          BFvaOvrVob.000:
            id: 169784761
            value: 375000.0
          BIvaCevCae.000:
            id: 179889458
            value: -32052.6
          BIvaCevCuh.000:
            id: 179889460
            value: 0.0
          BIvaCevCuhBeg.000:
            id: 179889596
            value: 1400.0
          BIvaCevCuhHer.000:
            id: 179889461
            value: -22000.0
          BIvaCevVvp.000:
            id: 179889459
            value: 123000.0
          BIvaGooCae.000:
            id: 179860448
            value: -10300.88
          BIvaGooCaeAfs.000:
            id: 179860450
            value: -2000.0
          BIvaGooCaeAfs.001:
            id: 179860449
            value: -3220.0
          BIvaGooVvp.000:
            id: 179860447
            value: 51700.0
          BLasAclAll.000:
            id: 179072786
            value: -120000.0
          BLasFlvClaAvp.000:
            id: 179319479
            value: 320000.0
          BLasFlvFlv.000:
            id: 179319478
            value: -382513.94
          BLasOlsOsl.000:
            id: 169784770
            value: -111524.0
          BLasOlsOsl.001:
            id: 169784771
            value: -52906.39
          BLasSakHvl.000:
            id: 169784706
            value: 0.0
          BLasSakLvl.000:
            id: 169784707
            value: 0.0
          BLasSakLvl.001:
            id: 169784762
            value: -650129.0
          BLasSakLvl.002:
            id: 169784772
            value: -250000.0
          BLasSuhSuh.000:
            id: 187144887
            value: 0.0
          BLasSuhSuh.001:
            id: 187144888
            value: 0.0
          BLimBanRba.000:
            id: 169784708
            value: 139698.62
          BLimBanRba.001:
            id: 169784709
            value: -94842.12
          BLimBanRba.002:
            id: 169784710
            value: 198.87
          BLimBanRbaBg1.000:
            id: 183751399
            value: 20999.0
          BLimBanRbaBg1.001:
            id: 183751400
            value: 0.0
          BMvaBegCae.000:
            id: 169784711
            value: -106549.05
          BMvaBegCuh.000:
            id: 178775618
            value: 27600.0
          BMvaBegCuh.001:
            id: 190737242
            value: -100000.0
          BMvaBegVvp.000:
            id: 169784712
            value: 655255.68
          BMvaBeiCae.000:
            id: 169784713
            value: -3838.19
          BMvaBeiVvp.000:
            id: 169784714
            value: 3838.19
          BMvaOrzVvp.000:
            id: 190737239
            value: 750000.0
          BMvaSchCaeAfs.000:
            id: 171119261
            value: 0.0
          BMvaSchVvpBeg.000:
            id: 171119260
            value: 0.0
          BMvaTevCae.000:
            id: 169784715
            value: -289883.91
          BMvaTevCuh.000:
            id: 178776422
            value: -14300.0
          BMvaTevVvp.000:
            id: 169784716
            value: 487170.98
          BSchBepBtwAfo.000:
            id: 172719002
            value: 0.0
          BSchBepBtwOla.000:
            id: 172719003
            value: 0.0
          BSchBepBtwVoo.000:
            id: 172719001
            value: 0.0
          BSchBepLhe.000:
            id: 169784717
            value: -14466.44
          BSchBepVpb.000:
            id: 169784718
            value: -208626.0
          BSchBepVpb.001:
            id: 187144890
            value: 0.0
          BSchCreHac.000:
            id: 169784719
            value: -11290.11
          BSchOpaNkf.000:
            id: 183751395
            value: 0.0
          BSchOpaNpe.000:
            id: 183751394
            value: 0.0
          BSchOpaNtb.000:
            id: 169784720
            value: -2500.0
          BSchOvsOvs.000:
            id: 183750467
            value: -8786.71
          BSchOvsSaa.000:
            id: 169784721
            value: 0.0
          BSchOvsTbd.000:
            id: 169784763
            value: 0.0
          BSchSakRbaBg1.000:
            id: 183751398
            value: 0.0
          BSchTusTbtTca.000:
            id: 191878894
            value: -675000.0
          BSchTusTov.000:
            id: 179898891
            value: -36823.89
          BSchTusTovTov.000:
            id: 179908723
            value: 0.0
          BSchTusTvr.000:
            id: 172340341
            value: 0.0
          BVorDebHad.000:
            id: 188024902
            value: 0.0
          BVorOvaVkf.000:
            id: 183751397
            value: 1250.0
          BVorOvaVkf.001:
            id: 183751396
            value: 1250.0
          BVorOvaVkf.002:
            id: 183753169
            value: 4000.0
          BVorOvaVop.000:
            id: 183753168
            value: 0.0
          BVorOvaVop.001:
            id: 183861898
            value: 4000.0
          BVorOvrOvk.000:
            id: 169784722
            value: 115961.74
          BVorOvrOvk.001:
            id: 169784723
            value: 26800.0
          BVorOvrOvk.002:
            id: 169784764
            value: 719.18
          BVorOvrRca.000:
            id: 183750468
            value: 1000.0
          BVorOvrVrb.000:
            id: 169784724
            value: 747.04
          BVorTusTbtTca.000:
            id: 187144891
            value: 0.0
          BVorVbkTvv.000:
            id: 186574585
            value: 0.0
          BVorVbkTvv.001:
            id: 187144889
            value: 0.0
          BVorVbkTvv.002:
            id: 183750470
            value: 3228.0
          BVorVovVr5Wve.000:
            id: 172724394
            value: 0.0
          BVrzOvzOvz.000:
            id: 169784725
            value: 0.0
          BVrzVvpVpd.000:
            id: 169784726
            value: 0.0
          WAfsAivCev.000:
            id: 179889457
            value: 12487.87
          WAfsAivGoo.000:
            id: 179860451
            value: 4848.0
          WAfsAmvBeg.000:
            id: 169784727
            value: 16902.71
          WAfsAmvObe.000:
            id: 190737240
            value: 50000.0
          WAfsAmvTev.000:
            id: 169784728
            value: 43007.88
          WAfsRviOiv.000:
            id: 169784773
            value: -9119.2
          WAfsRvm.000:
            id: 178776423
            value: 14300.0
          WAfsRvmObe.000:
            id: 190737241
            value: -25000.0
          WBedAdlBan.000:
            id: 169784729
            value: 1435.34
          WBedAdlBan.001:
            id: 169784730
            value: 20739.27
          WBedAeaAeaAnc.000:
            id: 169784731
            value: 1500.0
          WBedAeaAeaAnc.001:
            id: 169784732
            value: 2500.0
          WBedAlkOal.000:
            id: 169784733
            value: 2646.0
          WBedAlkOal.001:
            id: 169784734
            value: 0.0
          WBedAlkOal.002:
            id: 169784735
            value: 0.0
          WBedAlkOal.003:
            id: 169784736
            value: 0.0
          WBedAssOva.000:
            id: 169784737
            value: 4338.14
          WBedAutBop.000:
            id: 169784738
            value: 0.0
          WBedAutBra.000:
            id: 169784739
            value: 4544.37
          WBedAutMot.000:
            id: 169784740
            value: 3304.0
          WBedAutOpa.000:
            id: 169784741
            value: 557.02
          WBedEemRoi.000:
            id: 169784756
            value: 5815.14
          WBedHuiBeh.000:
            id: 169784742
            value: 0.0
          WBedHuiObh.000:
            id: 169784757
            value: 1595.25
          WBedHuiOhv.000:
            id: 169784743
            value: 0.0
          WBedHuiOhv.001:
            id: 169784765
            value: 0.0
          WBedTraOtr.000:
            id: 169784766
            value: 45.77
          WBelBgrBgr.000:
            id: 169784744
            value: 208626.0
          WBelBgrBgr.001:
            id: 169784745
            value: 0.0
          WFbeOrlRlb.000:
            id: 183750469
            value: 1093.0
          WFbeRlmRbb.000:
            id: 169784774
            value: 0.0
          WFbeRlsRhl.000:
            id: 169784746
            value: 0.0
          WKprAklAfc.000:
            id: 186932220
            value: 0.0
          WOmzNodOdh.000:
            id: 169784747
            value: -30000.0
          WOmzNooNdo.000:
            id: 169784767
            value: 0.0
          WOvbBueSpo.000:
            id: 169784748
            value: -130000.0
          WOvbBueSpo.001:
            id: 169784749
            value: -36420.0
          WOvbHuoHuo.000:
            id: 169784750
            value: -50000.0
          WOvtRofRig.000:
            id: 169784751
            value: 0.0
          WOvtRofRvd.000:
            id: 169784752
            value: 0.0
          WOvtRofRvd.001:
            id: 169784768
            value: 0.0
          WPerLesLon.000:
            id: 169784753
            value: 80000.04
          WPerLesTep.000:
            id: 169784758
            value: 0.0
          WPerPenDpe.000:
            id: 169784754
            value: 0.0
          WRedAirAwd.000:
            id: 169784755
            value: -26800.0
          WWvvOwvOwv.000:
            id: 178775619
            value: -27600.0
        reconciliations:
          nl_deductible_gifts:
            custom:
              check.approval: true
              cult_gifts.cult_gift_1:
                amount: '500.0'
                description: 'First item

                  '
              cult_gifts.cult_gift_2:
                amount: '1500.0'
                description: 'Second item


                  '
              oth_gifts.oth_gift_1:
                amount: '2200.0'
                description: Charitable donation (1)
              oth_gifts.oth_gift_2:
                amount: '4200.0'
                description: Charitable donation (2)
              total_gifts.in_admin: false
          nl_tax_status:
            custom:
              check.show_relevant_years: true
              corp_tax_pay_rec.applicable: true
              corp_tax_status.corp_tax_status_2017_1:
                corp_tax: null
                corp_tax_year: '2017'
                paid_rec: null
                start: '78936.0'
              corp_tax_status.corp_tax_status_2018_2:
                corp_tax: null
                corp_tax_year: '2018'
                paid_rec: null
                start: '6594.0'
              corporate_tax_status.current_start: ''
              dutch_income.py: '20606.0'
              equity.method: false
              external_results.external_result_1:
                amount: '999.0'
                description: dfiifififif
              external_results.external_result_2:
                amount: '100000.0'
                description: RBM BV
              foreign_company_profits_1.amount: '100000.0'
              loss_03_2016.loss: '-102000.0'
              loss_03_2016.settled: '30000.0'
              loss_03_2016.settled_previous_years: '70000.0'
              loss_03_2016.tax_deductions_additions: '-7000.0'
              loss_03_2017.settled: '500.0'
              loss_03_2018.settled_previous_years: '1500.0'
              loss_03_2018.tax_deductions_additions: '20000.0'
              loss_06_2015.loss: '-102000.0'
              loss_06_2015.settled: '30000.0'
              loss_06_2015.settled_previous_years: '70000.0'
              loss_06_2015.tax_deductions_additions: '-7000.0'
              loss_06_2016.settled: '500.0'
              loss_06_2017.loss: '50000.0'
              loss_06_2017.settled_previous_years: '1500.0'
              loss_06_2017.tax_deductions_additions: '20000.0'
              loss_09_2015.loss: '-102000.0'
              loss_09_2015.settled: '30000.0'
              loss_09_2015.settled_previous_years: '70000.0'
              loss_09_2015.tax_deductions_additions: '-7000.0'
              loss_09_2016.settled: '500.0'
              loss_09_2017.settled_previous_years: '1500.0'
              loss_09_2017.tax_deductions_additions: '20000.0'
              loss_12_2007.loss: 0
              loss_12_2007.settled_previous_years: '0.0'
              loss_12_2007.tax_deductions_additions: 0
              loss_12_2008.loss: 0
              loss_12_2008.settled_previous_years: '0.0'
              loss_12_2008.tax_deductions_additions: 0
              loss_12_2009.loss: 0
              loss_12_2009.settled_previous_years: '0.0'
              loss_12_2009.tax_deductions_additions: 0
              loss_12_2010.loss: 0
              loss_12_2010.settled_previous_years: '0.0'
              loss_12_2010.tax_deductions_additions: 0
              loss_12_2011.loss: 0
              loss_12_2011.settled_previous_years: '0.0'
              loss_12_2011.tax_deductions_additions: 0
              loss_12_2012.loss: 0
              loss_12_2012.settled_previous_years: '0.0'
              loss_12_2012.tax_deductions_additions: 0
              loss_12_2013.loss: 0
              loss_12_2013.settled_previous_years: '0.0'
              loss_12_2013.tax_deductions_additions: 0
              loss_12_2014.loss: 0
              loss_12_2014.settled_previous_years: '0.0'
              loss_12_2014.tax_deductions_additions: 0
              loss_12_2015.loss: '-102000.0'
              loss_12_2015.settled: ''
              loss_12_2015.settled_previous_years: '100000.0'
              loss_12_2015.tax_deductions_additions: '-7000.0'
              loss_12_2016.loss: '-95510.0'
              loss_12_2016.settled: '0.0'
              loss_12_2016.settled_previous_years: '500.0'
              loss_12_2016.tax_deductions_additions: 0
              loss_12_2017.loss: null
              loss_12_2017.settled_previous_years: ''
              loss_12_2017.tax_deductions_additions: '20000.0'
              loss_12_2018.loss: '20606.0'
              loss_12_2018.settled_previous_years: '0.0'
              loss_12_2018.tax_deductions_additions: '0.0'
              loss_12_2020.loss: 0
              loss_12_2020.settled_previous_years: '1500.0'
              loss_12_2020.tax_deductions_additions: 0
              loss_Dec '15.loss: '-102000.0'
              loss_Dec '15.settled: '30000.0'
              loss_Dec '15.settled_previous_years: '70000.0'
              loss_Dec '15.tax_deductions_additions: '-7000.0'
              loss_Dec '16.settled: '500.0'
              loss_Dec '17.settled_previous_years: '1500.0'
              loss_Dec '17.tax_deductions_additions: '20000.0'
              loss_Jun '15.loss: '-102000.0'
              loss_Jun '15.settled: '30000.0'
              loss_Jun '15.settled_previous_years: '70000.0'
              loss_Jun '15.tax_deductions_additions: '-7000.0'
              loss_Jun '16.settled: '500.0'
              loss_Jun '17.settled_previous_years: '1500.0'
              loss_Jun '17.tax_deductions_additions: '20000.0'
              loss_Mar '16.loss: '-102000.0'
              loss_Mar '16.settled: '30000.0'
              loss_Mar '16.settled_previous_years: '70000.0'
              loss_Mar '16.tax_deductions_additions: '-7000.0'
              loss_Mar '17.settled: '500.0'
              loss_Mar '18.settled_previous_years: '1500.0'
              loss_Mar '18.tax_deductions_additions: '20000.0'
              loss_Sep '15.loss: '-102000.0'
              loss_Sep '15.settled: '30000.0'
              loss_Sep '15.settled_previous_years: '70000.0'
              loss_Sep '15.tax_deductions_additions: '-7000.0'
              loss_Sep '16.settled: '500.0'
              loss_Sep '17.settled_previous_years: '1500.0'
              loss_Sep '17.tax_deductions_additions: '20000.0'
              loss_carryforward.applicable: true
              loss_dec '19.loss: '1000.0'
              participation_exemption.amount: ''
              show.payable_ledger_spec: false
              specify.external_results: false
              tax_entity.applicable: true
              taxable_amount.applicable: true
  expectation:
    reconciled: false
    results:
      result_cy_a_priori: 136480
      approval: true
      approval_date: 20/04/2022
      approval_name: null
      data_included: true
      total_deductible: 9400.0
    rollforward:
      check.approval: null  

# Unit 2 fori items: 
unit_2_fori_items_test_1:
  context:
    locale: en
    period: '2019-12-31'
  data:
    periods:
      2019-12-31:
        accounts:
          WOvbBue.001:
            value: -124689
        reconciliations:
          nl_deductible_gifts:
            custom: &custom_fori_items_bp
              cult_gifts.cult_gift_1:
                amount: '500.0'
                description: First item
              cult_gifts.cult_gift_2:
                amount: '1500.0'
                description: Second item
              oth_gifts.oth_gift_1:
                amount: '2200.0'
                description: Charitable donation (1)
              oth_gifts.oth_gift_2:
                amount: '4200.0'
                description: Charitable donation (2)
          nl_tax_status:
            custom:
              equity.method: false
              
  expectation:
    reconciled: false
    rollforward:
      check.approval: null
    results:
      approval: false
      approval_name: null
      approval_date: null
      result_cy_a_priori: 124689.0
      total_deductible: 9400.0
      data_included: true

unit_2_fori_items_test_2:
  context:
    locale: en
    period: '2019-12-31'
  data:
    periods:
      2019-12-31:
        accounts:
          WOvbBue.001:
            value: -124689
        reconciliations:
          nl_deductible_gifts:
            custom:
              <<: *custom_fori_items_bp
              check.approval: true
          nl_tax_status:
            custom:
              equity.method: false
              
  expectation:
    reconciled: true
    rollforward:
      check.approval: null
    results:
      result_cy_a_priori: 124689
      approval: true
      approval_date: 20/04/2022
      approval_name: null
      data_included: true
      total_deductible: 9400.0

unit_2_fori_items_test_3:
  context:
    locale: en
    period: '2019-12-31'
  data:
    periods:
      2019-12-31:
        accounts:
          <<: *all_accounts_bp
        reconciliations:
          nl_deductible_gifts:
            custom:
              <<: *custom_fori_items_bp
              check.approval: true
          nl_tax_status:
            custom:
              equity.method: true
              
  expectation:
    reconciled: true
    rollforward:
      check.approval: null
    results:
      result_cy_a_priori: 307778
      approval: true
      approval_date: 20/04/2022
      approval_name: null
      data_included: true
      total_deductible: 9400.0

#UNIT 3: BUTTON TOTAL GIFTS ALREADY IN ADMIN
unit_3_total_gifts_included_test_1:
  context:
    period: 2021-12-31
    locale: 'en'
  data:
    periods:
      2021-12-31:
        accounts:
          <<: *basic_pl_accounts_bp
        reconciliations:
          nl_deductible_gifts:
            custom:
              <<: *custom_fori_items_bp
              check.approval: true
          nl_tax_status:
            custom: 
              equity.method: false
  expectation:
    reconciled: true
    rollforward:
      check.approval: null
    results:
      result_cy_a_priori: 6000
      approval: true
      approval_date: 20/04/2022
      approval_name: null
      data_included: true
      total_deductible: 3000

unit_3_total_gifts_included_test_2:
  context:
    period: 2021-12-31
    locale: 'en'
  data:
    periods:
      2021-12-31:
        accounts:
          <<: *basic_pl_accounts_bp
        reconciliations:
          nl_deductible_gifts:
            custom:
              <<: *custom_fori_items_bp
              check.approval: true
              total_gifts.in_admin: true
          nl_tax_status:
            custom: 
              equity.method: false
  expectation:
    reconciled: true
    rollforward:
      check.approval: null
    results:
      result_cy_a_priori: 14400
      approval: true
      approval_date: 20/04/2022
      approval_name: null
      data_included: true
      total_deductible: 7200


